template_path: consul/asg.j2
parameters:
  Env: {{ envname }}
  VPC: !stack_output {{ envname }}/network/vpc.yaml::VPC
  SubnetIds:
    - !stack_output {{ envname }}/network/vpc.yaml::PubSubnet1
    - !stack_output {{ envname }}/network/vpc.yaml::PubSubnet2
    - !stack_output {{ envname }}/network/vpc.yaml::PubSubnet3
  SecurityGroupId: !stack_output {{ envname }}/consul/consul.yaml::SecurityGroup
  Profile: !stack_output {{ envname }}/consul/iam.yaml::Profile
  AMI: !environment_variable CONSUL1AMI
  InstanceType: t2.micro
  InstanceQty: '1'
  TargetGroup: !stack_output {{ envname }}/consul/nlb.yaml::DNSTargetGroup
  PublicIP: 'true'
